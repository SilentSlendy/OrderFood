<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="POS.Views.InvoiceView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:POS.Views"
    xmlns:model="using:POS.Models"
    xmlns:local4="using:POS.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="ms-appx:///Styles/CustomStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <local4:DateTimeToDateConverter x:Key="DateTimeToDateConverter"/>
            <local4:PaymentMethodToStatusInvoiceConverter x:Key="PaymentMethodToStatusInvoiceConverter"/>
            <local4:PaymentMethodToBackgroundColorConverter x:Key="PaymentMethodToBackgroundColorConverter"/>
            <local4:PaymentMethodToIconConverter x:Key="PaymentMethodToIconConverter"/>
            <local4:PaymentMethodToBackgroundColorHeaderConverter x:Key="PaymentMethodToBackgroundColorHeaderConverter"/>
            <SolidColorBrush 
                    x:Key="SystemControlPageBackgroundBaseMediumBrush" 
                    Color="#99000000"
                    />
        </ResourceDictionary>
    </Page.Resources>
    <Grid Background="Beige">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
                <RowDefinition Height="50"/>
            </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal" BorderBrush="BurlyWood" Grid.Row="0" Margin="20">
            <!--search bar-->
            <AutoSuggestBox 
        x:Name="SearchBox"
        PlaceholderText="Nhập ID hóa đơn" 
        FontSize="12" 
        Width="360"  
        Height="40" 
        Margin="40 0 40 0" 
        VerticalContentAlignment="Center" 
        QueryIcon="Find" 
		QuerySubmitted="AutoSuggestBox_QuerySubmitted"
       />
        </StackPanel>
        <!--add, edit, remove-->
            <!--Update later-->
        <StackPanel HorizontalAlignment="Right" Orientation="Horizontal" Margin="40 0 40 0">
            <Button Content="Đặt thêm món" Margin="88 0 20 0" Padding="10" HorizontalAlignment="Center" Click="OrderMoreDishes_Click"/>
            <Button Content="Xóa hóa đơn" Padding="8"  Margin="0 0 20 0" HorizontalAlignment="Center"/>
            <Button Content="Thanh toán"  Padding="8" Margin="0 0 20 0" HorizontalAlignment="Center" Background="#99ffcc"/>
            </StackPanel>
        

        <GridView Grid.Row="1" ItemsSource="{x:Bind ViewModel.Invoices, Mode=OneWay}" HorizontalAlignment="Center" SelectionChanged="InvoiceSelectionChanged">
            <GridView.ItemTemplate>
                <DataTemplate x:DataType="model:WholeInvoice">
                    <Grid Width="180" Height="250" Background="White" Margin="10" CornerRadius="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid Background= "{x:Bind Invoice.PaymentMethod, Converter={StaticResource PaymentMethodToBackgroundColorHeaderConverter}, Mode=OneWay}" Padding="10" Grid.Row="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock FontWeight="Bold">
                                #<Run Text="{x:Bind Invoice.InvoiceID, Mode=OneWay}"/>
                            </TextBlock>
                            <StackPanel HorizontalAlignment="Right" Grid.Row="0">
                            <TextBlock FontWeight="SemiBold">
                                <Run Text="{x:Bind Invoice.InvoiceDate,Converter={StaticResource DateTimeToDateConverter}, Mode=OneWay}"/>
                            </TextBlock>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Right" Grid.Row="1" 
                                        Background="{x:Bind Invoice.PaymentMethod,Converter={StaticResource PaymentMethodToBackgroundColorConverter}}"
                                        CornerRadius="5" Padding="4" Margin="0 8 0 0">
                                <TextBlock>
                                    <Run Text="{x:Bind Invoice.PaymentMethod,Converter={StaticResource PaymentMethodToStatusInvoiceConverter}, Mode=OneWay}"/>
                                </TextBlock>
                                <!--<ContentControl Content="{x:Bind Invoice.PaymentMethod, Converter={StaticResource PaymentMethodToIconConverter}}"/>-->
                                <ContentControl Content="{x:Bind Invoice.PaymentMethod,Converter={StaticResource PaymentMethodToIconConverter},Mode=OneWay}"/>
                            </StackPanel>
                        </Grid>
                        <ListView ItemsSource="{x:Bind InvoiceDetailsWithProductInfo}" Grid.Row="1">
                            <ListView.ItemTemplate>
                                <DataTemplate x:DataType="model:InvoiceDetailWithProductInfo">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock FontSize="20" Text="{x:Bind InvoiceDetailProperty.Quantity, Mode=OneWay}"/>
                                        <StackPanel Width="150">
                                            <TextBlock Grid.Row="0" Margin="10 0" FontSize="20" Text="{x:Bind ProductName, Mode=OneWay}" TextWrapping="Wrap"/>
                                            <TextBlock Grid.Row="1" Foreground="Red" Margin="10 0" Text="{x:Bind InvoiceDetailProperty.Note, Mode=OneWay}" TextWrapping="Wrap"/>
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </DataTemplate>
            </GridView.ItemTemplate>
        </GridView>
   
        <!--paging-->
        <Grid Grid.Row="2">
            <StackPanel Orientation="Vertical" HorizontalAlignment="Left">
                <TextBlock>
     Tổng hóa đơn: <Run Text="{x:Bind ViewModel.TotalItems}"></Run>
                </TextBlock>
                <TextBlock>
     Hiển thị: <Run Text="{x:Bind ViewModel.Invoices.Count, Mode=OneWay}"></Run>/<Run Text="{x:Bind ViewModel.ItemsPerPage}"></Run>
                </TextBlock>
            </StackPanel>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Button Name="previousButton" Width="80" Height="35" Content="&lt; Back" Click="previousButton_Click"/>
                <!--combobox phân trang-->
                <ComboBox Name="pagesComboBox" Width="100" Height="35" SelectionChanged="pagesComboBox_SelectionChanged" HorizontalAlignment="Center">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock>

                 <Run Text="{Binding Page}"/> / <Run Text="{Binding Total}"/>

                            </TextBlock>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Button Name="nextButton" Width="80" Height="35" Content="Next &gt;" Click="nextButton_Click"/>
            </StackPanel>
        </Grid>
    </Grid>
</Page>
